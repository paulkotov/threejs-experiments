<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ThreeJS experiments</title>

  <!-- ThreeJS Core -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

  <!-- ThreeJS Controls -->
  <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>

  <!-- Stats.js for performance monitoring (optional) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r17/Stats.min.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <!-- Load the WebGLDriver class -->
  <script src="main.js"></script>

  <script>
    // Create an instance of WebGLDriver with custom configuration
    const driver = new WebGLDriver({
      backgroundColor: 0x1a1a2e,
      antialias: true,
      shadows: true,
      controls: true,
      stats: true,
      debug: true
    });

    // Override the setup method to create our 3D scene
    driver.setup = function () {
      // Create a rotating cube
      const cubeGeometry = new THREE.BoxGeometry(1, 1, 1);
      const cubeMaterial = new THREE.MeshStandardMaterial({
        color: 0x00ff88,
        metalness: 0.5,
        roughness: 0.2
      });
      this.cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
      this.cube.position.set(-2, 0, 0);
      this.cube.castShadow = true;
      this.cube.receiveShadow = true;
      this.addToScene(this.cube);

      // Create a sphere
      const sphereGeometry = new THREE.SphereGeometry(0.7, 32, 32);
      const sphereMaterial = new THREE.MeshStandardMaterial({
        color: 0xff6b6b,
        metalness: 0.3,
        roughness: 0.4
      });
      this.sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
      this.sphere.position.set(0, 0, 0);
      this.sphere.castShadow = true;
      this.sphere.receiveShadow = true;
      this.addToScene(this.sphere);

      // Create a torus
      const torusGeometry = new THREE.TorusGeometry(0.6, 0.2, 16, 100);
      const torusMaterial = new THREE.MeshStandardMaterial({
        color: 0x4ecdc4,
        metalness: 0.6,
        roughness: 0.3
      });
      this.torus = new THREE.Mesh(torusGeometry, torusMaterial);
      this.torus.position.set(2, 0, 0);
      this.torus.castShadow = true;
      this.torus.receiveShadow = true;
      this.addToScene(this.torus);

      // Create a ground plane
      const planeGeometry = new THREE.PlaneGeometry(10, 10);
      const planeMaterial = new THREE.MeshStandardMaterial({
        color: 0x333333,
        metalness: 0.1,
        roughness: 0.8
      });
      this.plane = new THREE.Mesh(planeGeometry, planeMaterial);
      this.plane.rotation.x = -Math.PI / 2;
      this.plane.position.y = -1.5;
      this.plane.receiveShadow = true;
      this.addToScene(this.plane);

      // Add extra point light for more interesting lighting
      const pointLight = new THREE.PointLight(0xff9900, 1, 100);
      pointLight.position.set(-5, 3, -5);
      this.addToScene(pointLight);

      console.log('3D Scene setup complete!');
    };

    // Override the update method to add animations
    driver.update = function (deltaTime, elapsedTime) {
      if (this.cube) {
        this.cube.rotation.x += deltaTime * 0.5;
        this.cube.rotation.y += deltaTime * 0.8;
      }

      if (this.sphere) {
        this.sphere.position.y = Math.sin(elapsedTime * 2) * 0.5;
        this.sphere.rotation.y += deltaTime * 1.5;
      }

      if (this.torus) {
        this.torus.rotation.x += deltaTime * 0.7;
        this.torus.rotation.y += deltaTime * 0.3;
      }
    };

    // Manually call setup since it was already called (empty) in the constructor
    driver.setup();
  </script>
</body>

</html>