<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ThreeJS experiments</title>

  <!-- ThreeJS Core -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

  <!-- ThreeJS Controls -->
  <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>

  <!-- Stats.js for performance monitoring (optional) -->
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r17/Stats.min.js"></script> -->

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <!-- Load the WebGLDriver class -->
  <script src="main.js"></script>

  <script>
    // Create an instance of WebGLDriver with custom configuration and callbacks
    const driver = new WebGLDriver({
      // Renderer configuration
      backgroundColor: 0x1a1a2e,
      antialias: true,
      shadows: true,

      // Features
      controls: true,
      stats: true,
      debug: true,

      // Scene setup callback
      setup: function () {
        // Create a rotating cube using the helper method
        this.cube = this.createMesh(
          new THREE.BoxGeometry(1, 1, 1),
          new THREE.MeshStandardMaterial({
            color: 0x00ff88,
            metalness: 0.5,
            roughness: 0.2
          }),
          {
            position: { x: -2, y: 0, z: 0 },
            castShadow: true,
            receiveShadow: true,
            name: 'cube'
          }
        );

        // Create a sphere using the helper method
        this.sphere = this.createMesh(
          new THREE.SphereGeometry(0.7, 32, 32),
          new THREE.MeshStandardMaterial({
            color: 0xff6b6b,
            metalness: 0.3,
            roughness: 0.4
          }),
          {
            position: { x: 0, y: 0, z: 0 },
            castShadow: true,
            receiveShadow: true,
            name: 'sphere'
          }
        );

        // Create a torus using the helper method
        this.torus = this.createMesh(
          new THREE.TorusGeometry(0.6, 0.2, 16, 100),
          new THREE.MeshStandardMaterial({
            color: 0x4ecdc4,
            metalness: 0.6,
            roughness: 0.3
          }),
          {
            position: { x: 2, y: 0, z: 0 },
            castShadow: true,
            receiveShadow: true,
            name: 'torus'
          }
        );

        // Create a ground plane using the helper method
        this.plane = this.createMesh(
          new THREE.PlaneGeometry(10, 10),
          new THREE.MeshStandardMaterial({
            color: 0x333333,
            metalness: 0.1,
            roughness: 0.8
          }),
          {
            position: { x: 0, y: -1.5, z: 0 },
            rotation: { x: -Math.PI / 2, y: 0, z: 0 },
            receiveShadow: true,
            name: 'ground'
          }
        );

        // Add extra point light using the helper method
        this.createLight('point', {
          color: 0xff9900,
          intensity: 1,
          distance: 100,
          position: { x: -5, y: 3, z: -5 },
          name: 'accentLight'
        });

        console.log('3D Scene setup complete!');
      },

      // Animation update callback
      update: function (deltaTime, elapsedTime) {
        // Rotate the cube
        if (this.cube) {
          this.cube.rotation.x += deltaTime * 0.5;
          this.cube.rotation.y += deltaTime * 0.8;
        }

        // Animate sphere with bounce
        if (this.sphere) {
          this.sphere.position.y = Math.sin(elapsedTime * 2) * 0.5;
          this.sphere.rotation.y += deltaTime * 1.5;
        }

        // Rotate the torus
        if (this.torus) {
          this.torus.rotation.x += deltaTime * 0.7;
          this.torus.rotation.y += deltaTime * 0.3;
        }
      }
    });
  </script>
</body>

</html>